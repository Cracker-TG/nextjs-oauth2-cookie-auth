{"version":3,"file":"7.1fe2d29204b3d0899395.hot-update.js","sources":["webpack:///utils/withAuth.js"],"sourcesContent":["import React, {Component} from 'react'\nimport Router from 'next/router'\nimport AuthService from './AuthService'\nimport { getCookie, setCookie } from '../utils/Cookies'\nimport cookie from \"js-cookie\";\n\nexport default function withAuth(AuthComponent) {\n    const Auth = new AuthService(process.env.API_DOMAIN_URL)\n    return class Authenticated extends Component {\n\n      static async getInitialProps(ctx) {\n        const isServer = !!ctx.req\n\n        // Ensures material-ui renders the correct css prefixes server-side\n        let userAgent\n        let seshToken\n        if (!isServer) {\n          userAgent = navigator.userAgent\n          seshToken = cookie.get('seshToken');\n        } else {\n          userAgent = ctx.req.headers['user-agent']\n          seshToken = getCookie('seshToken', ctx.req);\n        }\n        let isLoading = true\n        if (!seshToken) {\n          // ctx.res.writeHead(301, {\n          //   Location: `http://localhost/oauth/authorize/?client_id=4&redirect_uri=http://localhost:3000/token&response_type=code`\n          // })\n          // ctx.res.end()\n        } else {\n          setCookie('seshToken', seshToken)\n          isLoading = false\n        }\n        \n        // Check if Page has a `getInitialProps`; if so, call it.\n        const pageProps = AuthComponent.getInitialProps && await AuthComponent.getInitialProps(ctx);\n        // Return props.\n        return { \n          ...pageProps,\n          userAgent,\n          isLoading,\n          seshToken\n        }\n      }\n\n      constructor(props) {\n        super(props)\n        this.state = {\n          isLoading: props.isLoading,\n          token: props.seshToken\n        };\n      }\n\n      componentDidMount () {\n        if (!this.state.token) {\n          Router.push('/')\n        } \n        this.setState({ isLoading: false })\n      }\n\n      render() {\n        return (\n          <div>\n          {this.state.isLoading ? (\n              <div>LOADING....</div>\n            ) : (\n              <AuthComponent {...this.props}  auth={Auth} token={this.state.token} />\n            )}\n          </div>\n        )\n      }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// utils/withAuth.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1BA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AA2BA;AA3BA;AA+BA;AACA;AACA;AAjCA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AAoCA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAFA;AAMA;AACA;AA5CA;AAAA;AAAA;AA8CA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAlDA;AAAA;AAAA;AAqDA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AA9DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAgEA;;;;;;;;;;;;AAlEA;;;;;;;;;A","sourceRoot":""}